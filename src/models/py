************* Module src.models.srp_base
srp_base.py:238:28: C0303: Trailing whitespace (trailing-whitespace)
srp_base.py:439:36: W0511: TODO: step per epoch is hard-coded (fixme)
srp_base.py:56:8: C0103: Attribute name "pm" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:69:4: W0237: Parameter 'args' has been renamed to 'cfg' in overriding 'SRPModelBase.build_model' method (arguments-renamed)
srp_base.py:117:29: W0613: Unused argument 'cfg' (unused-argument)
srp_base.py:146:4: W0221: Variadics removed in overriding 'SRPModelBase.forward' method (arguments-differ)
srp_base.py:163:8: R1703: The if statement can be replaced with 'var = bool(test)' (simplifiable-if-statement)
srp_base.py:168:8: R1705: Unnecessary "else" after "return", remove the "else" and de-indent the code inside it (no-else-return)
srp_base.py:234:8: C0103: Variable name "pm" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:235:8: C0103: Variable name "pd" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:238:14: W0212: Access to a protected member _decreasing of a client class (protected-access)
srp_base.py:240:8: C0206: Consider iterating with .items() (consider-using-dict-items)
srp_base.py:240:18: C0201: Consider iterating the dictionary directly instead of calling .keys() (consider-iterating-dictionary)
srp_base.py:250:16: W0719: Raising too general exception: Exception (broad-exception-raised)
srp_base.py:286:26: W0622: Redefining built-in 'type' (redefined-builtin)
srp_base.py:255:8: C0103: Variable name "pm" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:256:8: C0103: Variable name "pd" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:267:12: R1724: Unnecessary "elif" after "continue", remove the leading "el" from "elif" (no-else-continue)
srp_base.py:286:22: C0103: Variable name "ly" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:286:32: C0103: Variable name "wb" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:296:22: C0103: Variable name "ly" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:296:32: C0103: Variable name "wb" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:325:22: C0103: Variable name "ly" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:325:32: C0103: Variable name "wb" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:253:4: R0912: Too many branches (27/12) (too-many-branches)
srp_base.py:253:4: R0915: Too many statements (88/50) (too-many-statements)
srp_base.py:258:8: W0612: Unused variable 'en_heads' (unused-variable)
srp_base.py:259:8: W0612: Unused variable 'de_heads' (unused-variable)
srp_base.py:286:26: W0612: Unused variable 'type' (unused-variable)
srp_base.py:286:32: W0612: Unused variable 'wb' (unused-variable)
srp_base.py:375:16: C0103: Variable name "ly" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:406:4: C0103: Variable name "m" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:426:8: C0103: Attribute name "fc" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:430:8: C0103: Attribute name "qk" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:431:8: C0103: Attribute name "vo" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:446:8: C0103: Attribute name "p" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:466:12: W0719: Raising too general exception: Exception (broad-exception-raised)
srp_base.py:481:8: C0103: Variable name "n1" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:482:8: C0103: Variable name "n2" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:489:8: C0103: Variable name "a" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:490:8: C0103: Variable name "b" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:492:8: C0103: Variable name "p" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:502:8: C0103: Variable name "fc" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:503:8: C0103: Variable name "qk" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:504:8: C0103: Variable name "vo" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:507:12: C0103: Variable name "fc" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:508:12: C0103: Variable name "qk" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:509:12: C0103: Variable name "vo" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:529:8: C0103: Variable name "gl" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:541:24: C0103: Argument name "e" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:552:25: R1716: Simplify chained comparison between the operands (chained-comparison)
srp_base.py:555:25: R1716: Simplify chained comparison between the operands (chained-comparison)
srp_base.py:560:37: C0103: Argument name "gl" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:568:35: C0103: Argument name "pn" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:576:16: C0103: Variable name "ly" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:595:33: C0103: Argument name "fc" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:602:16: C0103: Variable name "ly" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:613:16: C0103: Variable name "ly" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:640:18: W0622: Redefining built-in 'type' (redefined-builtin)
srp_base.py:640:14: C0103: Variable name "ly" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:640:24: C0103: Variable name "wb" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:644:15: W0718: Catching too general exception Exception (broad-exception-caught)
srp_base.py:643:18: C0103: Variable name "ly" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:643:28: C0103: Variable name "wb" doesn't conform to snake_case naming style (invalid-name)
srp_base.py:25:0: W0611: Unused fsdp_wrap imported from fairseq.distributed (unused-import)
************* Module src.models.srp_config
srp_config.py:70:0: C0301: Line too long (103/100) (line-too-long)
srp_config.py:136:0: C0301: Line too long (109/100) (line-too-long)
srp_config.py:148:0: C0301: Line too long (103/100) (line-too-long)
srp_config.py:179:0: C0301: Line too long (127/100) (line-too-long)
srp_config.py:185:0: C0301: Line too long (108/100) (line-too-long)
srp_config.py:195:0: C0301: Line too long (107/100) (line-too-long)
srp_config.py:242:0: C0303: Trailing whitespace (trailing-whitespace)
srp_config.py:256:0: C0303: Trailing whitespace (trailing-whitespace)
srp_config.py:263:0: C0303: Trailing whitespace (trailing-whitespace)
srp_config.py:277:0: C0303: Trailing whitespace (trailing-whitespace)
srp_config.py:308:0: C0303: Trailing whitespace (trailing-whitespace)
srp_config.py:383:0: C0301: Line too long (111/100) (line-too-long)
srp_config.py:386:0: C0301: Line too long (105/100) (line-too-long)
srp_config.py:390:0: C0301: Line too long (136/100) (line-too-long)
srp_config.py:421:0: C0301: Line too long (175/100) (line-too-long)
srp_config.py:119:5: W0511: TODO should really be in the encoder config (fixme)
srp_config.py:125:5: W0511: TODO should really be in the decoder config (fixme)
srp_config.py:1:0: C0114: Missing module docstring (missing-module-docstring)
srp_config.py:37:0: C0115: Missing class docstring (missing-class-docstring)
srp_config.py:37:0: R0902: Too many instance attributes (9/7) (too-many-instance-attributes)
srp_config.py:65:0: C0115: Missing class docstring (missing-class-docstring)
srp_config.py:83:0: C0115: Missing class docstring (missing-class-docstring)
srp_config.py:84:4: C0103: Attribute name "pq" doesn't conform to snake_case naming style (invalid-name)
srp_config.py:101:0: C0115: Missing class docstring (missing-class-docstring)
srp_config.py:328:4: C0103: Attribute name "T" doesn't conform to snake_case naming style (invalid-name)
srp_config.py:101:0: R0902: Too many instance attributes (47/7) (too-many-instance-attributes)
srp_config.py:377:8: R1705: Unnecessary "else" after "return", remove the "else" and de-indent the code inside it (no-else-return)
srp_config.py:374:4: R0912: Too many branches (16/12) (too-many-branches)
************* Module src.models.srp_decoder
srp_decoder.py:372:0: C0303: Trailing whitespace (trailing-whitespace)
srp_decoder.py:453:0: C0301: Line too long (104/100) (line-too-long)
srp_decoder.py:1:0: C0114: Missing module docstring (missing-module-docstring)
srp_decoder.py:21:0: R0402: Use 'from torch import nn' instead (consider-using-from-import)
srp_decoder.py:42:0: C0116: Missing function or method docstring (missing-function-docstring)
srp_decoder.py:43:4: R1705: Unnecessary "else" after "return", remove the "else" and de-indent the code inside it (no-else-return)
srp_decoder.py:49:0: R0902: Too many instance attributes (25/7) (too-many-instance-attributes)
srp_decoder.py:62:4: R0913: Too many arguments (6/5) (too-many-arguments)
srp_decoder.py:73:28: E1101: Module 'torch' has no 'empty' member (no-member)
srp_decoder.py:118:40: E1101: Module 'torch' has no 'ones' member (no-member)
srp_decoder.py:119:41: E1101: Module 'torch' has no 'zeros' member (no-member)
srp_decoder.py:156:4: C0116: Missing function or method docstring (missing-function-docstring)
srp_decoder.py:188:4: C0116: Missing function or method docstring (missing-function-docstring)
srp_decoder.py:200:4: W0221: Variadics removed in overriding 'SRPDecoderBase.forward' method (arguments-differ)
srp_decoder.py:200:4: R0913: Too many arguments (12/5) (too-many-arguments)
srp_decoder.py:233:12: C0103: Variable name "x" doesn't conform to snake_case naming style (invalid-name)
srp_decoder.py:244:12: C0103: Variable name "x" doesn't conform to snake_case naming style (invalid-name)
srp_decoder.py:257:16: C0103: Variable name "x" doesn't conform to snake_case naming style (invalid-name)
srp_decoder.py:258:12: C0103: Variable name "x" doesn't conform to snake_case naming style (invalid-name)
srp_decoder.py:209:8: W0613: Unused argument 'src_lengths' (unused-argument)
srp_decoder.py:210:8: W0613: Unused argument 'return_all_hiddens' (unused-argument)
srp_decoder.py:264:4: W0221: Variadics removed in overriding 'SRPDecoderBase.extract_features' method (arguments-differ)
srp_decoder.py:264:4: R0913: Too many arguments (9/5) (too-many-arguments)
srp_decoder.py:286:4: W0105: String statement has no effect (pointless-string-statement)
srp_decoder.py:292:4: R0913: Too many arguments (9/5) (too-many-arguments)
srp_decoder.py:292:4: R0914: Too many local variables (24/15) (too-many-locals)
srp_decoder.py:322:8: C0103: Variable name "bs" doesn't conform to snake_case naming style (invalid-name)
srp_decoder.py:346:8: C0103: Variable name "x" doesn't conform to snake_case naming style (invalid-name)
srp_decoder.py:349:12: C0103: Variable name "x" doesn't conform to snake_case naming style (invalid-name)
srp_decoder.py:352:12: C0103: Variable name "x" doesn't conform to snake_case naming style (invalid-name)
srp_decoder.py:355:12: C0103: Variable name "x" doesn't conform to snake_case naming style (invalid-name)
srp_decoder.py:358:12: C0103: Variable name "x" doesn't conform to snake_case naming style (invalid-name)
srp_decoder.py:360:8: C0103: Variable name "x" doesn't conform to snake_case naming style (invalid-name)
srp_decoder.py:363:12: C0103: Variable name "x" doesn't conform to snake_case naming style (invalid-name)
srp_decoder.py:367:8: C0103: Variable name "x" doesn't conform to snake_case naming style (invalid-name)
srp_decoder.py:383:16: C0103: Variable name "x" doesn't conform to snake_case naming style (invalid-name)
srp_decoder.py:396:16: C0103: Variable name "x" doesn't conform to snake_case naming style (invalid-name)
srp_decoder.py:396:34: C0103: Variable name "hs" doesn't conform to snake_case naming style (invalid-name)
srp_decoder.py:425:12: C0103: Variable name "x" doesn't conform to snake_case naming style (invalid-name)
srp_decoder.py:428:8: C0103: Variable name "x" doesn't conform to snake_case naming style (invalid-name)
srp_decoder.py:431:12: C0103: Variable name "x" doesn't conform to snake_case naming style (invalid-name)
srp_decoder.py:292:4: R0912: Too many branches (23/12) (too-many-branches)
srp_decoder.py:292:4: R0915: Too many statements (60/50) (too-many-statements)
srp_decoder.py:322:8: W0612: Unused variable 'bs' (unused-variable)
srp_decoder.py:322:12: W0612: Unused variable 'slen' (unused-variable)
srp_decoder.py:437:4: W0221: Variadics removed in overriding 'SRPDecoderBase.output_layer' method (arguments-differ)
srp_decoder.py:439:8: R1705: Unnecessary "else" after "return", remove the "else" and de-indent the code inside it (no-else-return)
srp_decoder.py:451:4: C0116: Missing function or method docstring (missing-function-docstring)
srp_decoder.py:459:32: E1101: Module 'torch' has no 'triu' member (no-member)
srp_decoder.py:460:40: E1101: Module 'torch' has no 'zeros' member (no-member)
srp_decoder.py:468:26: C0209: Formatting a regular string which could be a f-string (consider-using-f-string)
srp_decoder.py:472:16: C0209: Formatting a regular string which could be a f-string (consider-using-f-string)
srp_decoder.py:473:16: E1101: Module 'torch' has no 'FloatTensor' member (no-member)
srp_decoder.py:495:20: C0103: Variable name "m" doesn't conform to snake_case naming style (invalid-name)
srp_decoder.py:496:24: C0209: Formatting a regular string which could be a f-string (consider-using-f-string)
srp_decoder.py:499:28: C0209: Formatting a regular string which could be a f-string (consider-using-f-string)
srp_decoder.py:503:22: C0209: Formatting a regular string which could be a f-string (consider-using-f-string)
srp_decoder.py:507:12: W0201: Attribute 'normalize' defined outside __init__ (attribute-defined-outside-init)
srp_decoder.py:513:0: C0116: Missing function or method docstring (missing-function-docstring)
srp_decoder.py:513:0: C0103: Function name "Linear" doesn't conform to snake_case naming style (invalid-name)
srp_decoder.py:514:4: C0103: Variable name "m" doesn't conform to snake_case naming style (invalid-name)
srp_decoder.py:521:0: C0115: Missing class docstring (missing-class-docstring)
srp_decoder.py:522:4: R0913: Too many arguments (6/5) (too-many-arguments)
srp_decoder.py:539:4: W0237: Parameter 'cfg' has been renamed to 'args' in overriding 'SRPDecoder.build_output_projection' method (arguments-renamed)
srp_decoder.py:544:4: W0237: Parameter 'cfg' has been renamed to 'args' in overriding 'SRPDecoder.build_decoder_layer' method (arguments-renamed)
srp_decoder.py:28:0: C0411: third party import "from fairseq.modules import AdaptiveSoftmax, BaseLayer, FairseqDropout, LayerDropModuleList, PositionalEmbedding, SinusoidalPositionalEmbedding" should be placed before "from .srp_config import SRPConfig" (wrong-import-order)
srp_decoder.py:37:0: C0411: third party import "from fairseq.modules.checkpoint_activations import checkpoint_wrapper" should be placed before "from .srp_config import SRPConfig" (wrong-import-order)
srp_decoder.py:38:0: C0411: third party import "from fairseq.modules.quant_noise import quant_noise as apply_quant_noise_" should be placed before "from .srp_config import SRPConfig" (wrong-import-order)
************* Module src.models.srp_encoder
srp_encoder.py:314:0: C0303: Trailing whitespace (trailing-whitespace)
srp_encoder.py:1:0: C0114: Missing module docstring (missing-module-docstring)
srp_encoder.py:21:0: R0402: Use 'from torch import nn' instead (consider-using-from-import)
srp_encoder.py:39:0: C0116: Missing function or method docstring (missing-function-docstring)
srp_encoder.py:40:4: R1705: Unnecessary "else" after "return", remove the "else" and de-indent the code inside it (no-else-return)
srp_encoder.py:46:0: R0902: Too many instance attributes (17/7) (too-many-instance-attributes)
srp_encoder.py:87:40: E1101: Module 'torch' has no 'ones' member (no-member)
srp_encoder.py:88:41: E1101: Module 'torch' has no 'zeros' member (no-member)
srp_encoder.py:120:4: C0116: Missing function or method docstring (missing-function-docstring)
srp_encoder.py:134:4: C0116: Missing function or method docstring (missing-function-docstring)
srp_encoder.py:140:8: C0103: Variable name "x" doesn't conform to snake_case naming style (invalid-name)
srp_encoder.py:142:12: C0103: Variable name "x" doesn't conform to snake_case naming style (invalid-name)
srp_encoder.py:144:12: C0103: Variable name "x" doesn't conform to snake_case naming style (invalid-name)
srp_encoder.py:145:8: C0103: Variable name "x" doesn't conform to snake_case naming style (invalid-name)
srp_encoder.py:147:12: C0103: Variable name "x" doesn't conform to snake_case naming style (invalid-name)
srp_encoder.py:150:4: W0221: Variadics removed in overriding 'SRPEncoderBase.forward' method (arguments-differ)
srp_encoder.py:150:4: R0913: Too many arguments (7/5) (too-many-arguments)
srp_encoder.py:191:4: R0913: Too many arguments (7/5) (too-many-arguments)
srp_encoder.py:191:4: R0914: Too many local variables (19/15) (too-many-locals)
srp_encoder.py:227:8: C0103: Variable name "x" doesn't conform to snake_case naming style (invalid-name)
srp_encoder.py:230:12: C0103: Variable name "x" doesn't conform to snake_case naming style (invalid-name)
srp_encoder.py:234:12: C0103: Variable name "x" doesn't conform to snake_case naming style (invalid-name)
srp_encoder.py:237:8: C0103: Variable name "x" doesn't conform to snake_case naming style (invalid-name)
srp_encoder.py:249:16: C0103: Variable name "lr" doesn't conform to snake_case naming style (invalid-name)
srp_encoder.py:254:16: C0103: Variable name "lr" doesn't conform to snake_case naming style (invalid-name)
srp_encoder.py:254:20: C0103: Variable name "hs" doesn't conform to snake_case naming style (invalid-name)
srp_encoder.py:262:16: C0103: Variable name "x" doesn't conform to snake_case naming style (invalid-name)
srp_encoder.py:264:16: C0103: Variable name "x" doesn't conform to snake_case naming style (invalid-name)
srp_encoder.py:272:8: W0105: String statement has no effect (pointless-string-statement)
srp_encoder.py:284:30: E1101: Module 'torch' has no 'int32' member (no-member)
srp_encoder.py:306:8: R1705: Unnecessary "else" after "return", remove the "else" and de-indent the code inside it (no-else-return)
srp_encoder.py:377:73: W0613: Unused argument 'new_order' (unused-argument)
srp_encoder.py:390:26: C0209: Formatting a regular string which could be a f-string (consider-using-f-string)
srp_encoder.py:392:22: C0209: Formatting a regular string which could be a f-string (consider-using-f-string)
srp_encoder.py:395:16: C0209: Formatting a regular string which could be a f-string (consider-using-f-string)
srp_encoder.py:396:16: E1101: Module 'torch' has no 'FloatTensor' member (no-member)
srp_encoder.py:400:28: C0209: Formatting a regular string which could be a f-string (consider-using-f-string)
srp_encoder.py:403:22: C0209: Formatting a regular string which could be a f-string (consider-using-f-string)
srp_encoder.py:406:12: W0201: Attribute 'layer_norm' defined outside __init__ (attribute-defined-outside-init)
srp_encoder.py:407:12: W0201: Attribute 'normalize' defined outside __init__ (attribute-defined-outside-init)
srp_encoder.py:412:0: C0115: Missing class docstring (missing-class-docstring)
srp_encoder.py:422:4: W0237: Parameter 'cfg' has been renamed to 'args' in overriding 'SRPEncoder.build_encoder_layer' method (arguments-renamed)
srp_encoder.py:32:0: C0411: third party import "from fairseq.modules.checkpoint_activations import checkpoint_wrapper" should be placed before "from ..modules import srp_layer, LayerNorm" (wrong-import-order)
srp_encoder.py:33:0: C0411: third party import "from fairseq.modules.quant_noise import quant_noise as apply_quant_noise_" should be placed before "from ..modules import srp_layer, LayerNorm" (wrong-import-order)
srp_encoder.py:34:0: C0411: third party import "from torch import Tensor" should be placed before "from ..modules import srp_layer, LayerNorm" (wrong-import-order)
************* Module src.models.srp_legacy
srp_legacy.py:39:0: C0303: Trailing whitespace (trailing-whitespace)
srp_legacy.py:78:0: C0301: Line too long (102/100) (line-too-long)
srp_legacy.py:218:0: C0305: Trailing newlines (trailing-newlines)
srp_legacy.py:1:0: C0114: Missing module docstring (missing-module-docstring)
srp_legacy.py:55:4: W0237: Parameter 'cfg' has been renamed to 'args' in overriding 'SRPModel.build_model' method (arguments-renamed)
srp_legacy.py:99:4: W0237: Parameter 'cfg' has been renamed to 'args' in overriding 'SRPModel.build_embedding' method (arguments-renamed)
srp_legacy.py:105:4: W0237: Parameter 'cfg' has been renamed to 'args' in overriding 'SRPModel.build_encoder' method (arguments-renamed)
srp_legacy.py:111:4: W0237: Parameter 'cfg' has been renamed to 'args' in overriding 'SRPModel.build_decoder' method (arguments-renamed)
srp_legacy.py:120:0: C0116: Missing function or method docstring (missing-function-docstring)
srp_legacy.py:176:0: C0116: Missing function or method docstring (missing-function-docstring)
srp_legacy.py:189:0: C0116: Missing function or method docstring (missing-function-docstring)
srp_legacy.py:201:0: C0116: Missing function or method docstring (missing-function-docstring)
srp_legacy.py:207:0: C0116: Missing function or method docstring (missing-function-docstring)
srp_legacy.py:1:0: R0801: Similar lines in 2 files
==src.models.srp_decoder:[112:125]
==src.models.srp_encoder:[81:94]
            )
            if not cfg.no_token_positional_embeddings
            else None
        )

        self.embedding_c = nn.Parameter(torch.ones(embed_dim), requires_grad=True)
        self.pos_emb_mask = nn.Parameter(torch.zeros(0), requires_grad=False)

        if cfg.layernorm_embedding:
            self.layernorm_embedding = LayerNorm(embed_dim, export=cfg.export)
        else:
            self.layernorm_embedding = None
 (duplicate-code)
srp_legacy.py:1:0: R0801: Similar lines in 2 files
==src.models.srp_decoder:[92:101]
==src.models.srp_encoder:[94:103]
        if not cfg.adaptive_input and cfg.quant_noise.pq > 0:
            self.quant_noise = apply_quant_noise_(
                nn.Linear(embed_dim, embed_dim, bias=False),
                cfg.quant_noise.pq,
                cfg.quant_noise.pq_block_size,
            )
        else:
            self.quant_noise = None
 (duplicate-code)
srp_legacy.py:1:0: R0801: Similar lines in 2 files
==src.models.srp_decoder:[189:231]
==src.models.srp_encoder:[123:137]
        checkpoint = cfg.checkpoint_activations
        if checkpoint:
            offload_to_cpu = cfg.offload_activations
            layer = checkpoint_wrapper(layer, offload_to_cpu=offload_to_cpu)
        # if we are checkpointing, enforce that FSDP always wraps the
        # checkpointed layer, regardless of layer size
        min_params_to_wrap = cfg.min_params_to_wrap if not checkpoint else 0
        layer = fsdp_wrap(layer, min_num_params=min_params_to_wrap)
        return layer

    def forward_embedding(
        self, src_tokens, token_embedding: Optional[torch.Tensor] = None
    ):
        # embed tokens and positions (duplicate-code)
srp_legacy.py:1:0: R0801: Similar lines in 2 files
==src.models.srp_decoder:[529:534]
==src.models.srp_encoder:[413:418]
        self.args = args
        super().__init__(
            SRPConfig.from_namespace(args),
            dictionary,
            embed_tokens, (duplicate-code)

-----------------------------------
Your code has been rated at 7.34/10

